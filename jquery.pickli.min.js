(function(e){var t={"default":null,index:-1,value:null,labelKey:"label",valueKey:"value",autoErase:false,data:[],remote:{url:false,type:"GET",data:null,loader:null,crossDomain:false,onRemoteStart:null,onRemoteSuccess:null,onRemoteError:null},size:"100%",orientation:"horizontal",wrapperClass:"pickli",selectAlign:"center",unselectAlign:"center",selectClass:"active",unselectClass:"",autoResize:false,interaction:"click",cursor:"pointer",loop:false,transition:{duration:"normal",easing:"swing",onTransitionStart:null,onTransitionComplete:null},onFill:null,onChange:null,infinite:false};e.fn.pickli=function(n){function c(e){var t=r.settings.transition;r.settings.transition=false;l(e);v();r.settings.transition=t}function h(e){var t=r.settings.transition;r.settings.transition=false;d(e);v();r.settings.transition=t}function y(){var t=0;e("li",i).each(function(){t+=e(this)[r.settings.prop_outer_size](true)});return t}if(this.length==0)return this;if(this.length>1){this.each(function(){e(this).pickli(n)});return this}var r={};var i=this;var s=function(){r.settings=e.extend({},t,n);r.settings.wrapper=null;if(r.settings.orientation=="horizontal"){r.settings.wrapper_whiteSpace="nowrap";r.settings.wrapper_overflowX="hidden";r.settings.wrapper_overflowY="auto";r.settings.prop_pos="left";r.settings.prop_size="width";r.settings.prop_cliente_size="clientWidth";r.settings.prop_outer_size="outerWidth";r.settings.display_prop="inline-block"}else if(r.settings.orientation=="vertical"){r.settings.wrapper_whiteSpace="normal";r.settings.wrapper_overflowX="auto";r.settings.wrapper_overflowY="hidden";r.settings.prop_pos="top";r.settings.prop_size="height";r.settings.prop_cliente_size="clientHeight";r.settings.prop_outer_size="outerHeight";r.settings.display_prop="block"}o()};var o=function(){i.wrap("<div></div>");r.settings.wrapper=i.parent();r.settings.wrapper.css({"white-space":r.settings.wrapper_whiteSpace,"overflow-x":r.settings.wrapper_overflowX,"overflow-y":r.settings.wrapper_overflowY,margin:"0px",padding:"0px"});r.settings.wrapper.css(r.settings.prop_size,r.settings.size);r.settings.wrapper.addClass(r.settings.wrapperClass);if(r.settings.cursor)i.css("cursor",r.settings.cursor);b();w();u()};var u=function(){if(!r.settings.data)r.settings.data=[];if(e("li",i).length>0){var t=[];e("li",i).each(function(){var n={};n[r.settings.labelKey]=e(this).html();n[r.settings.valueKey]=e(this).attr("value");t.push(n)});r.settings.data=e.merge(t,r.settings.data);i.empty()}f();a();if(r.settings.index>=0)h(r.settings.index);else c(r.settings.value)};var a=function(){if(r.settings.remote&&r.settings.remote.url){if(r.settings.remote.loader)r.settings.remote.loader.show();if(r.settings.remote.onRemoteStart)r.settings.remote.onRemoteStart();e.ajax({url:r.settings.remote.url,type:r.settings.remote.type,data:r.settings.remote.data,crossDomain:r.settings.remote.crossDomain,success:function(e){r.settings.data=e;f();c(r.settings.value);if(r.settings.remote.loader)r.settings.remote.loader.hide();if(r.settings.remote.onRemoteSuccess)r.settings.remote.onRemoteSuccess(e)},error:function(e){if(r.settings.remote.loader)r.settings.remote.loader.hide();if(r.settings.remote.onRemoteError)r.settings.remote.onRemoteError(e)}})}};var f=function(){if(r.settings.autoErase)i.empty();if(r.settings.data){for(var e=0;e<r.settings.data.length;e++){i.append('<li value="'+r.settings.data[e][r.settings.valueKey]+'" style="display:'+r.settings.display_prop+';">'+r.settings.data[e][r.settings.labelKey]+"</li>")}}if(r.settings.onFill)r.settings.onFill(r.settings.data)};var l=function(t){var n=e('li[value="'+t+'"]',i);if(n.length>0)d(n.index());else p()};var p=function(){var t=e('li[value="'+r.settings.default+'"]',i);if(t.length>0)d(t.index());else{r.settings.defaults=null;d(null)}};var d=function(t){if(t<0)t=r.settings.loop?e("li",i).length-1:0;else if(t>=e("li",i).length)t=r.settings.loop?0:e("li",i).length-1;if(t!==r.settings.index){r.settings.index=t;v();if(r.settings.onChange)r.settings.onChange(m())}};var v=function(){var t=r.settings.index;var n=0;e("li",i).removeClass(r.settings.selectClass).addClass(r.settings.unselectClass);if(t!=null&&t>=0){var s=e("li:nth-child("+(t+1)+")",i);var o=s.position()[r.settings.prop_pos]-r.settings.wrapper.position()[r.settings.prop_pos]-i.css("margin-"+r.settings.prop_pos).replace("px","");switch(r.settings.selectAlign){case"left":n=-o;break;case"center":n=parseInt(r.settings.wrapper[r.settings.prop_size]()*.5)-o-parseInt(s[0][r.settings.prop_cliente_size]*.5);break;case"right":n=r.settings.wrapper[r.settings.prop_size]()-o-s[0][r.settings.prop_cliente_size];break}s.removeClass(r.settings.unselectClass).addClass(r.settings.selectClass)}else{switch(r.settings.unselectAlign){case"left":n=0;break;case"center":n=parseInt(r.settings.wrapper[r.settings.prop_size]()*.5)-parseInt(y()*.5);break;case"right":n=r.settings.wrapper[r.settings.prop_size]()-y();break}}var u={};u["margin-"+r.settings.prop_pos]=n+"px";if(r.settings.transition){i.stop(true,false).animate(u,{duration:r.settings.transition.duration,easing:r.settings.transition.easing,start:function(){if(r.settings.transition.onPickliAnimateStart)r.settings.transition.onTransitionStart()},complete:function(){if(r.settings.transition.onPickliAnimateComplete)r.settings.transition.onTransitionComplete()}})}else{i.css(u)}};var m=function(){if(r.settings.index==null)return null;var t=e("li:nth-child("+(r.settings.index+1)+")",i);if(t.length>0)return t.attr("value");else return null};var g=function(){var t=[];if(e("li",i).length>0){e("li",i).each(function(){var n={};n[r.settings.labelKey]=e(this).html();n[r.settings.valueKey]=e(this).attr("value");t.push(n)})}return t};var b=function(){i.off();if(r.settings.interaction){var t=r.settings.interaction.split(" ");for(var n=t.length-1;n>=0;n--){t[n]=t[n]+".pickli"}i.on(t.join(" "),"li",function(){d(e(this).index())})}};var w=function(){e(window).off("resize",E);if(r.settings.autoResize){e(window).resize(E)}};var E=function(){v()};i.value=function(e){if(typeof e!="undefined")l(e);return m()};i.index=function(e){if(typeof e!="undefined")d(e);return r.settings.index};i.default=function(e){if(typeof e!="undefined"){r.settings.default=e;v()}return r.settings.default};i.valueKey=function(e){if(typeof e!="undefined"){r.settings.valueKey=e}return r.settings.valueKey};i.labelKey=function(e){if(typeof e!="undefined"){r.settings.labelKey=e}return r.settings.labelKey};i.data=function(e){if(typeof e!="undefined"){r.settings.data=e;f();v()}return g()};i.remote=function(n){if(typeof n!="undefined"){if(n){if(typeof n=="string")r.settings.remote.url=n;else if(typeof n=="object")r.settings.remote=e.extend({},r.settings.remote?r.settings.remote:t.remote,n);else r.settings.remote=false}else r.settings.remote=false}a()};i.autoErase=function(e){if(typeof e!="undefined"){r.settings.autoErase=e}return r.settings.autoErase};i.size=function(e){if(typeof e!="undefined"){r.settings.size=e;r.settings.wrapper.css("width",r.settings.size);v()}return r.settings.size};i.wrapperClass=function(e){if(typeof e!="undefined"){r.settings.wrapper.removeClass(r.settings.wrapperClass);r.settings.wrapperClass=e;r.settings.wrapper.addClass(r.settings.wrapperClass);v()}return r.settings.wrapperClass};i.selectAlign=function(e){if(typeof e!="undefined"){r.settings.selectAlign=e;v()}return r.settings.selectAlign};i.unselectAlign=function(e){if(typeof e!="undefined"){r.settings.unselectAlign=e;v()}return r.settings.unselectAlign};i.selectClass=function(t){if(typeof t!="undefined"){e("li",i).removeClass(r.settings.selectClass);r.settings.selectClass=t;v()}return r.settings.selectClass};i.unselectClass=function(t){if(typeof t!="undefined"){e("li",i).removeClass(r.settings.unselectClass);r.settings.unselectClass=t;v()}return r.settings.unselectClass};i.autoResize=function(e){if(typeof e!="undefined"){r.settings.autoResize=e;w();v()}return r.settings.autoResize};i.interaction=function(e){if(typeof e!="undefined"){r.settings.interaction=e;b()}return r.settings.interaction};i.transition=function(n){if(typeof n!="undefined"){if(n&&typeof n=="object")r.settings.transition=e.extend({},r.settings.transition?r.settings.transition:t.transition,n);else r.settings.transition=n}return r.settings.transition};i.loop=function(e){if(typeof e!="undefined"){r.settings.loop=e}return r.settings.loop};i.cursor=function(e){if(typeof e!="undefined"){r.settings.cursor=e;if(r.settings.cursor)i.css("cursor",r.settings.cursor)}return r.settings.cursor};i.onChange=function(e){if(typeof e!="undefined"){r.settings.onChange=e}return r.settings.onChange};i.onFill=function(e){if(typeof e!="undefined"){r.settings.onFill=e}return r.settings.onFill};i.next=function(){if(r.settings.index!=null){d(r.settings.index+1)}};i.prev=function(){if(r.settings.index!=null){d(r.settings.index-1)}};i.first=function(){d(0)};i.last=function(){d(e("li",i).length-1)};i.jump=function(e){d(r.settings.index+e)};i.refresh=function(){v()};s();return this}})(jQuery)
